ylab(paste0("PC2 (",round(summary(all.pca)$importance[2,2]*100, 2), "%)")) +
xlab(paste0("PC1 (",round(summary(all.pca)$importance[2,1]*100, 2), "%)"))
ggplot(as.data.frame(all.pca$x), aes(PC1, PC2)) +
geom_point(aes(shape = Combined), size = I(2)) +
xlim(-18, 18) +
multivar.theme +
scale_shape_manual(name = NULL,
values = c(1, 16, 2, 17),
labels = levels(Combined),
guide = guide_legend(nrow = 1)) +
theme(legend.position = "bottom") +
theme(legend.spacing.x = unit(0.9, "lines")) +
#theme(legend.key.size = unit(.68, "lines")) +
ylab(paste0("PC2 (",round(summary(all.pca)$importance[2,2]*100, 2), "%)")) +
xlab(paste0("PC1 (",round(summary(all.pca)$importance[2,1]*100, 2), "%)"))
ggsave("Comparison PCA bw5.png", height = 3.33, width = 3.5, units = "in")
ggplot(as.data.frame(all.pca$x), aes(PC1, PC2)) +
geom_point(aes(shape = Combined), size = I(2)) +
xlim(-18, 18) +
multivar.theme +
scale_shape_manual(name = NULL,
values = c(1, 16, 2, 17),
labels = levels(Combined),
guide = guide_legend(nrow = 1)) +
theme(legend.position = "bottom") +
theme(legend.spacing.x = unit(0.4, "lines")) +
#theme(legend.key.size = unit(.68, "lines")) +
ylab(paste0("PC2 (",round(summary(all.pca)$importance[2,2]*100, 2), "%)")) +
xlab(paste0("PC1 (",round(summary(all.pca)$importance[2,1]*100, 2), "%)"))
ggsave("Comparison PCA bw5.png", height = 3.33, width = 3.5, units = "in")
ggplot(as.data.frame(all.pca$x), aes(PC1, PC2)) +
geom_point(aes(shape = Combined), size = I(2)) +
xlim(-18, 18) +
multivar.theme +
scale_shape_manual(name = NULL,
values = c(1, 16, 2, 17),
labels = levels(Combined),
guide = guide_legend(nrow = 1)) +
theme(legend.position = "bottom") +
theme(legend.spacing.x = unit(0.1, "lines")) +
#theme(legend.key.size = unit(.68, "lines")) +
ylab(paste0("PC2 (",round(summary(all.pca)$importance[2,2]*100, 2), "%)")) +
xlab(paste0("PC1 (",round(summary(all.pca)$importance[2,1]*100, 2), "%)"))
ggsave("Comparison PCA bw5.png", height = 3.33, width = 3.5, units = "in")
ggplot(as.data.frame(all.pca$x), aes(PC1, PC2)) +
geom_point(aes(shape = Combined), size = I(2)) +
xlim(-18, 18) +
multivar.theme +
scale_shape_manual(name = NULL,
values = c(1, 16, 2, 17),
labels = levels(Combined),
guide = guide_legend(nrow = 1)) +
theme(legend.position = "bottom") +
theme(legend.key.size = unit(.68, "lines")) +
ylab(paste0("PC2 (",round(summary(all.pca)$importance[2,2]*100, 2), "%)")) +
xlab(paste0("PC1 (",round(summary(all.pca)$importance[2,1]*100, 2), "%)"))
ggsave("Comparison PCA bw5.png", height = 3.33, width = 3.5, units = "in")
ggplot(as.data.frame(all.pca$x), aes(PC1, PC2)) +
geom_point(aes(shape = Combined), size = I(2)) +
xlim(-18, 18) +
multivar.theme +
scale_shape_manual(name = NULL,
values = c(1, 16, 2, 17),
labels = levels(Combined),
guide = guide_legend(nrow = 1)) +
theme(legend.position = "bottom") +
theme(legend.key.size = unit(.68, "lines")) +
theme(legend.margin = 1)
ggplot(as.data.frame(all.pca$x), aes(PC1, PC2)) +
geom_point(aes(shape = Combined), size = I(2)) +
xlim(-18, 18) +
multivar.theme +
scale_shape_manual(name = NULL,
values = c(1, 16, 2, 17),
labels = levels(Combined),
guide = guide_legend(nrow = 1)) +
theme(legend.position = "bottom") +
theme(legend.key.size = unit(.68, "lines")) +
theme(legend.margin = unit(1, "lines"))
ggplot(as.data.frame(all.pca$x), aes(PC1, PC2)) +
geom_point(aes(shape = Combined), size = I(2)) +
xlim(-18, 18) +
multivar.theme +
scale_shape_manual(name = NULL,
values = c(1, 16, 2, 17),
labels = levels(Combined),
guide = guide_legend(nrow = 1)) +
theme(legend.position = "bottom") +
theme(legend.key.size = unit(.68, "lines")) +
theme(legend.margin = unit(1, "lines")) +
ylab(paste0("PC2 (",round(summary(all.pca)$importance[2,2]*100, 2), "%)")) +
xlab(paste0("PC1 (",round(summary(all.pca)$importance[2,1]*100, 2), "%)"))
ggplot(as.data.frame(all.pca$x), aes(PC1, PC2)) +
geom_point(aes(shape = Combined), size = I(2)) +
xlim(-18, 18) +
multivar.theme +
scale_shape_manual(name = NULL,
values = c(1, 16, 2, 17),
labels = levels(Combined),
guide = guide_legend(nrow = 1)) +
theme(legend.position = "bottom") +
theme(legend.key.size = unit(.68, "lines")) +
theme(legend.margin = unit(1.5, "lines")) +
ylab(paste0("PC2 (",round(summary(all.pca)$importance[2,2]*100, 2), "%)")) +
xlab(paste0("PC1 (",round(summary(all.pca)$importance[2,1]*100, 2), "%)"))
ggplot(as.data.frame(all.pca$x), aes(PC1, PC2)) +
geom_point(aes(shape = Combined), size = I(2)) +
xlim(-18, 18) +
multivar.theme +
scale_shape_manual(name = NULL,
values = c(1, 16, 2, 17),
labels = levels(Combined),
guide = guide_legend(nrow = 1)) +
theme(legend.position = "bottom") +
theme(legend.key.size = unit(.68, "lines")) +
theme(legend.margin = margin(t = 1, b = 1, r = 1, l = 1)) +
ylab(paste0("PC2 (",round(summary(all.pca)$importance[2,2]*100, 2), "%)")) +
xlab(paste0("PC1 (",round(summary(all.pca)$importance[2,1]*100, 2), "%)"))
ggsave("Comparison PCA bw5.png", height = 3.33, width = 3.5, units = "in")
ggplot(as.data.frame(all.pca$x), aes(PC1, PC2)) +
geom_point(aes(shape = Combined), size = I(2)) +
xlim(-18, 18) +
multivar.theme +
scale_shape_manual(name = NULL,
values = c(1, 16, 2, 17),
labels = levels(Combined),
guide = guide_legend(nrow = 1)) +
theme(legend.position = "bottom") +
theme(legend.key.size = unit(.68, "lines")) +
theme(legend.margin = margin(t = 1, b = 1, r = 1.5, l = 1)) +
ylab(paste0("PC2 (",round(summary(all.pca)$importance[2,2]*100, 2), "%)")) +
xlab(paste0("PC1 (",round(summary(all.pca)$importance[2,1]*100, 2), "%)"))
ggsave("Comparison PCA bw5.png", height = 3.33, width = 3.5, units = "in")
ggplot(as.data.frame(all.pca$x), aes(PC1, PC2)) +
geom_point(aes(shape = Combined), size = I(2)) +
xlim(-18, 18) +
multivar.theme +
scale_shape_manual(name = NULL,
values = c(1, 16, 2, 17),
labels = levels(Combined),
guide = guide_legend(nrow = 1)) +
theme(legend.position = "bottom") +
theme(legend.key.size = unit(.68, "lines")) +
theme(legend.margin = margin(t = 1, b = 1, r = 2, l = 1)) +
ylab(paste0("PC2 (",round(summary(all.pca)$importance[2,2]*100, 2), "%)")) +
xlab(paste0("PC1 (",round(summary(all.pca)$importance[2,1]*100, 2), "%)"))
ggsave("Comparison PCA bw5.png", height = 3.33, width = 3.5, units = "in")
ggplot(as.data.frame(all.pca$x), aes(PC1, PC2)) +
geom_point(aes(shape = Combined), size = I(2)) +
xlim(-18, 18) +
multivar.theme +
scale_shape_manual(name = NULL,
values = c(1, 16, 2, 17),
labels = levels(Combined),
guide = guide_legend(nrow = 1)) +
theme(legend.position = "bottom") +
theme(legend.key.size = unit(.68, "lines")) +
theme(legend.margin = margin(t = 1, b = 1, r = 5, l = 1)) +
ylab(paste0("PC2 (",round(summary(all.pca)$importance[2,2]*100, 2), "%)")) +
xlab(paste0("PC1 (",round(summary(all.pca)$importance[2,1]*100, 2), "%)"))
ggsave("Comparison PCA bw5.png", height = 3.33, width = 3.5, units = "in")
ggplot(as.data.frame(all.pca$x), aes(PC1, PC2)) +
geom_point(aes(shape = Combined), size = I(2)) +
xlim(-18, 18) +
multivar.theme +
scale_shape_manual(name = NULL,
values = c(1, 16, 2, 17),
labels = levels(Combined),
guide = guide_legend(nrow = 1)) +
theme(legend.position = "bottom") +
theme(legend.key.size = unit(.68, "lines")) +
theme(legend.margin = margin(t = 5, b = 5, r = 10, l = 5)) +
ylab(paste0("PC2 (",round(summary(all.pca)$importance[2,2]*100, 2), "%)")) +
xlab(paste0("PC1 (",round(summary(all.pca)$importance[2,1]*100, 2), "%)"))
ggsave("Comparison PCA bw5.png", height = 3.33, width = 3.5, units = "in")
ggplot(as.data.frame(all.pca$x), aes(PC1, PC2)) +
geom_point(aes(shape = Combined), size = I(2)) +
xlim(-18, 18) +
multivar.theme +
scale_shape_manual(name = NULL,
values = c(1, 16, 2, 17),
labels = levels(Combined),
guide = guide_legend(nrow = 1)) +
theme(legend.position = "bottom") +
theme(legend.key.size = unit(.68, "lines")) +
theme(legend.margin = margin(t = 3, b = 3, r = 8, l = 3)) +
ylab(paste0("PC2 (",round(summary(all.pca)$importance[2,2]*100, 2), "%)")) +
xlab(paste0("PC1 (",round(summary(all.pca)$importance[2,1]*100, 2), "%)"))
ggsave("Comparison PCA bw5.png", height = 3.33, width = 3.5, units = "in")
ggplot(as.data.frame(all.pca$x), aes(PC1, PC2)) +
geom_point(aes(shape = Combined), size = I(2)) +
xlim(-18, 18) +
multivar.theme +
scale_shape_manual(name = NULL,
values = c(1, 16, 2, 17),
labels = levels(Combined),
guide = guide_legend(nrow = 1)) +
theme(legend.position = "bottom") +
theme(legend.key.size = unit(.68, "lines")) +
theme(legend.margin = margin(t = 3, b = 3, r = 8, l = 3)) +
ylab(paste0("PC2 (",round(summary(all.pca)$importance[2,2]*100, 2), "%)")) +
xlab(paste0("PC1 (",round(summary(all.pca)$importance[2,1]*100, 2), "%)"))
ggplot(as.data.frame(all.pca$x), aes(PC1, PC2)) +
geom_point(aes(shape = Combined), size = I(2)) +
xlim(-18, 18) +
multivar.theme +
scale_shape_manual(name = NULL,
values = c(1, 16, 2, 17),
labels = levels(Combined),
guide = guide_legend(nrow = 1)) +
theme(legend.position = "bottom") +
theme(legend.key.size = unit(.68, "lines")) +
theme(legend.margin = margin(t = 3, b = 3, r = 7, l = 2)) +
ylab(paste0("PC2 (",round(summary(all.pca)$importance[2,2]*100, 2), "%)")) +
xlab(paste0("PC1 (",round(summary(all.pca)$importance[2,1]*100, 2), "%)"))
ggsave("Comparison PCA bw5.png", height = 3.33, width = 3.5, units = "in")
ggplot(as.data.frame(all.pca$x), aes(PC1, PC2)) +
geom_point(aes(shape = Combined), size = I(2)) +
xlim(-18, 18) +
multivar.theme +
scale_shape_manual(name = NULL,
values = c(1, 16, 2, 17),
labels = levels(Combined),
guide = guide_legend(nrow = 1)) +
theme(legend.position = "bottom") +
theme(legend.key.size = unit(.68, "lines")) +
theme(legend.margin = margin(t = 3, b = 3, r = 7, l = 1)) +
ylab(paste0("PC2 (",round(summary(all.pca)$importance[2,2]*100, 2), "%)")) +
xlab(paste0("PC1 (",round(summary(all.pca)$importance[2,1]*100, 2), "%)"))
ggsave("Comparison PCA bw5.png", height = 3.33, width = 3.5, units = "in")
ggplot(as.data.frame(all.pca$x), aes(PC1, PC2)) +
geom_point(aes(shape = Combined), size = I(2)) +
xlim(-18, 18) +
multivar.theme +
scale_shape_manual(name = NULL,
values = c(1, 16, 2, 17),
labels = levels(Combined),
guide = guide_legend(nrow = 1)) +
theme(legend.position = "bottom") +
theme(legend.key.size = unit(.68, "lines")) +
theme(legend.margin = margin(t = 3, b = 3, r = 5, l = 1)) +
ylab(paste0("PC2 (",round(summary(all.pca)$importance[2,2]*100, 2), "%)")) +
xlab(paste0("PC1 (",round(summary(all.pca)$importance[2,1]*100, 2), "%)"))
ggsave("Comparison PCA bw5.png", height = 3.33, width = 3.5, units = "in")
ggplot(as.data.frame(all.pca$x), aes(PC1, PC2)) +
geom_point(aes(shape = Combined), size = I(2)) +
xlim(-18, 18) +
multivar.theme +
scale_shape_manual(name = NULL,
values = c(1, 16, 2, 17),
labels = levels(Combined),
guide = guide_legend(nrow = 1)) +
theme(legend.position = "bottom") +
theme(legend.key.size = unit(.68, "lines")) +
theme(legend.margin = margin(t = 3, b = 3, r = 6, l = 1)) +
ylab(paste0("PC2 (",round(summary(all.pca)$importance[2,2]*100, 2), "%)")) +
xlab(paste0("PC1 (",round(summary(all.pca)$importance[2,1]*100, 2), "%)"))
ggsave("Comparison PCA bw5.png", height = 3.33, width = 3.5, units = "in")
ggplot(as.data.frame(all.pca$x), aes(PC1, PC2)) +
geom_point(aes(shape = Combined), size = I(2)) +
xlim(-18, 18) +
multivar.theme +
scale_shape_manual(name = NULL,
values = c(1, 16, 2, 17),
labels = levels(Combined),
guide = guide_legend(nrow = 1)) +
theme(legend.position = "top") +
theme(legend.key.size = unit(.68, "lines")) +
theme(legend.margin = margin(t = 3, b = 3, r = 6, l = 1)) +
ylab(paste0("PC2 (",round(summary(all.pca)$importance[2,2]*100, 2), "%)")) +
xlab(paste0("PC1 (",round(summary(all.pca)$importance[2,1]*100, 2), "%)"))
ggsave("Comparison PCA bw4.png", height = 3.33, width = 3.5, units = "in")
ggplot(as.data.frame(all.pca$x), aes(PC1, PC2)) +
geom_point(aes(shape = Combined), size = I(2)) +
xlim(-18, 18) +
multivar.theme +
scale_shape_manual(name = NULL,
values = c(1, 16, 2, 17),
labels = levels(Combined),
guide = NULL) +
theme(legend.position = "top") +
theme(legend.key.size = unit(.68, "lines")) +
theme(legend.margin = margin(t = 3, b = 3, r = 6, l = 1)) +
ylab(paste0("PC2 (",round(summary(all.pca)$importance[2,2]*100, 2), "%)")) +
xlab(paste0("PC1 (",round(summary(all.pca)$importance[2,1]*100, 2), "%)"))
ggplot(as.data.frame(all.pca$x), aes(PC1, PC2)) +
geom_point(aes(shape = Combined), size = I(2)) +
xlim(-18, 18) +
multivar.theme +
scale_shape_manual(name = NULL,
values = c(1, 16, 2, 17),
labels = levels(Combined),
guide = FALSE) +
theme(legend.position = "top") +
theme(legend.key.size = unit(.68, "lines")) +
theme(legend.margin = margin(t = 3, b = 3, r = 6, l = 1)) +
ylab(paste0("PC2 (",round(summary(all.pca)$importance[2,2]*100, 2), "%)")) +
xlab(paste0("PC1 (",round(summary(all.pca)$importance[2,1]*100, 2), "%)"))
ggsave("Comparison PCA bw4.png", height = 3.33, width = 3.5, units = "in")
ggplot(as.data.frame(all.pca$x), aes(PC1, PC2)) +
geom_point(aes(shape = Combined), size = I(2)) +
xlim(-18, 18) +
multivar.theme +
scale_shape_manual(name = NULL,
values = c(1, 16, 2, 17),
labels = levels(Combined),
guide = guide_legend(nrow = 1)) +
theme(legend.position = "top") +
theme(legend.key.size = unit(.68, "lines")) +
theme(legend.margin = margin(t = 3, b = 3, r = 6, l = 1)) +
ylab(paste0("PC2 (",round(summary(all.pca)$importance[2,2]*100, 2), "%)")) +
xlab(paste0("PC1 (",round(summary(all.pca)$importance[2,1]*100, 2), "%)"))
ggplot(as.data.frame(all.pca$x), aes(PC1, PC2)) +
geom_point(aes(shape = Combined), size = I(2)) +
xlim(-18, 18) +
multivar.theme +
scale_shape_manual(name = NULL,
values = c(1, 16, 2, 17),
labels = levels(Combined),
guide = FALSE) +
theme(legend.position = "top") +
theme(legend.key.size = unit(.68, "lines")) +
theme(legend.margin = margin(t = 3, b = 3, r = 6, l = 1)) +
ylab(paste0("PC2 (",round(summary(all.pca)$importance[2,2]*100, 2), "%)")) +
xlab(paste0("PC1 (",round(summary(all.pca)$importance[2,1]*100, 2), "%)"))
ggplot(as.data.frame(all.pca$x), aes(PC1, PC2)) +
geom_point(aes(shape = Combined), size = I(2)) +
xlim(-18, 18) +
multivar.theme +
scale_shape_manual(name = NULL,
values = c(1, 16, 2, 17),
labels = levels(Combined),
guide = guide_legend(nrow = 1)) +
theme(legend.position = "top") +
theme(legend.key.size = unit(.68, "lines")) +
theme(legend.margin = margin(t = 3, b = 3, r = 6, l = 1)) +
ylab(paste0("PC2 (",round(summary(all.pca)$importance[2,2]*100, 2), "%)")) +
xlab(paste0("PC1 (",round(summary(all.pca)$importance[2,1]*100, 2), "%)"))
ggsave("Comparison PCA bw4.png", height = 3.33, width = 3.5, units = "in")
setwd("~/Google Drive/R Code/Twister Data")
#setwd("/Users/escott03/Google Drive/R Code/Twister Data")
library(reshape2)
library(dplyr)
library(ggplot2)
library(readr)
#library(xlsx)
library(readxl)
library(car)
#library(scales)
#library(MASS)
library(RColorBrewer)
library(venn)
source("~/Google Drive/R Code/myfunctions.R")
#twister <- read_csv("Field.csv")
twister <- read_excel("Field2.xlsx", sheet = 3)
twister1 <- twister[1:149, 1:12]
twister1[is.na(twister1)] = 0 #missing cells represent undetected compounds
twist2 = recast(twister1, variable ~ Compound, measure.var = c(2:12)) #this transposes the data so each column is a compound, but it re-orders the columns, which I don't like.
twist2
colnames(twist2)[1] <- "samples"
#glimpse(twist2)
summary(twist2$samples)
Treatment<-c(rep("E. obliqua",3),rep("MeJA",4),rep("control",4))
dim(twist2)-1 #149
dim(twist2)-1 #149
x <- transmute(twister1, Control = con1 + con2 + con3 + con4,
MeJA = meja1 + meja2 + meja3 + meja4,
Geometrid = geo1 + geo2 + geo3)
x[x > 0] = 1
x$Compound <- twister1$Compound
x <- dplyr::select(x, Compound, everything())
venn(x[ , -1], cexil=1.5, cexsn=1.1)
colSums(x[ , -1])
#unique to Geometrid:
Geometrid.unique <- subset(x, x$Geometrid != 0 & x$MeJA == 0 & x$Control == 0)
Geometrid.unique
#unique to MeJA:
MeJA.unique <- subset(x, x$MeJA != 0 & x$Geometrid == 0 & x$Control == 0)
MeJA.unique
#unique to Control
Control.unique <- subset(x, x$Control != 0 & x$Geometrid == 0 & x$MeJA == 0)
Control.unique
tea.pca2<-prcomp(twist2[ , -1], scale. = TRUE, center = TRUE)
summary(tea.pca2)
#head(tea.pca2$rotation)
#screeplot(tea.pca2, type="lines")
##my ggplot2 theme
multivar.theme <- theme_bw(base_size = 7, base_family = "Helvetica")+  #this changes the default text size and font
theme(axis.title = element_text(size = 7),                      #this sets a different font size for the axis labels
panel.border = element_rect(size = .5, color = "black"),   #change size= here to change border size
panel.grid.major = element_blank(),                     #these two lines make the grid lines go away
panel.grid.minor = element_blank(),
legend.text = element_text(size = 7),                  #legend font size
legend.background = element_rect(color = "black", size = 0.25),
legend.key.size = unit(.75, "lines"))                    #spacing between text
#legend.spacing = unit(.4, "lines"))                     #spacing between legends if > 1
####Plotting PCA####
#Treatment
labels = expression("Control", italic("E. obliqua"), "MeJA")
cols <- c("control" = "#1b9e77", "MeJA" = "#d95f02", "E. obliqua" = "#7570b3")
#PC1 vs PC2
ggplot(as.data.frame(tea.pca2$x), aes(PC1, PC2, fill = Treatment)) +
geom_point(shape = 21, size = I(2)) +
scale_fill_manual(name = NULL, values = cols, labels = labels) +
multivar.theme +
theme(legend.position = "bottom") +
ylab(paste0("PC2 (",round(summary(tea.pca2)$importance[2,2]*100, 2), "%)")) +
xlab(paste0("PC1 (",round(summary(tea.pca2)$importance[2,1]*100, 2), "%)"))
ggsave("Field Trial.png", height = 3.5, width = 3.33, units = "in")
#PC2 vs PC3
#ggplot(as.data.frame(tea.pca2$x), aes(PC2, PC3, fill = Treatment)) +
#  geom_point(shape = 24, size = I(3)) +
#  scale_fill_manual(values = cols, labels = labels) +
#  multivar.theme +
#  theme(
#    legend.position = "right",
#  #legend.position=c(0.13,0.16), #puts it in the lower left
#    legend.text = element_text(size = 10),
#    legend.background = element_rect(color = "black")) +
#  ylab(paste0("PC3 (",round(summary(tea.pca2)$importance[2,3]*100, 2), "%)")) +
#  xlab(paste0("PC2 (",round(summary(tea.pca2)$importance[2,2]*100, 2), "%)"))
#ggsave("Field Trial2vs3.png", height = 3.5, width = 5, units = "in")
#black and white
ggplot(as.data.frame(tea.pca2$x), aes(PC1, PC2, shape = Treatment)) +
geom_point(size = I(2)) +
scale_shape_manual(name = NULL, values = c(16, 18, 17), labels = labels) +
multivar.theme +
#theme(legend.position = "bottom") +
ylab(paste0("PC2 (",round(summary(tea.pca2)$importance[2,2]*100, 2), "%)")) +
xlab(paste0("PC1 (",round(summary(tea.pca2)$importance[2,1]*100, 2), "%)"))
ggsave("Field Trial bw.png", height = 3.33, width = 5, units = "in")
#black and white with different fills instead of different symbols (robbat wants this)
ggplot(as.data.frame(tea.pca2$x), aes(PC1, PC2, shape = Treatment)) +
geom_point(size = I(2)) +
scale_shape_manual(name = NULL, values = c(1, 10, 16), labels = labels) +
multivar.theme +
#theme(legend.position = "bottom") +
ylab(paste0("PC2 (",round(summary(tea.pca2)$importance[2,2]*100, 2), "%)")) +
xlab(paste0("PC1 (",round(summary(tea.pca2)$importance[2,1]*100, 2), "%)"))
ggsave("Field Trial bw2.png", height = 3.33, width = 5, units = "in")
#try black, white, and grey
ggplot(as.data.frame(tea.pca2$x), aes(PC1, PC2, fill = Treatment)) +
geom_point(size = I(2), shape = 21) +
scale_fill_manual(name = NULL, values = c("white", "grey", "black"), labels = labels) +
multivar.theme +
#theme(legend.position = "bottom") +
ylab(paste0("PC2 (",round(summary(tea.pca2)$importance[2,2]*100, 2), "%)")) +
xlab(paste0("PC1 (",round(summary(tea.pca2)$importance[2,1]*100, 2), "%)"))
ggsave("Field Trial bw3.png", height = 3.33, width = 5, units = "in")
ggplot(as.data.frame(tea.pca2$x), aes(PC1, PC2, shape = Treatment)) +
geom_point(size = I(2)) +
scale_shape_manual(name = NULL, values = c(1, 10, 16), labels = labels) +
multivar.theme +
#theme(legend.position = "bottom") +
ylab(paste0("PC2 (",round(summary(tea.pca2)$importance[2,2]*100, 2), "%)")) +
xlab(paste0("PC1 (",round(summary(tea.pca2)$importance[2,1]*100, 2), "%)"))
ggplot(as.data.frame(tea.pca2$x), aes(PC1, PC2, fill = Treatment)) +
geom_point(size = I(2), shape = 21) +
scale_fill_manual(name = NULL, values = c("white", "grey", "black"), labels = labels) +
multivar.theme +
#theme(legend.position = "bottom") +
ylab(paste0("PC2 (",round(summary(tea.pca2)$importance[2,2]*100, 2), "%)")) +
xlab(paste0("PC1 (",round(summary(tea.pca2)$importance[2,1]*100, 2), "%)"))
ggplot(as.data.frame(tea.pca2$x), aes(PC1, PC2, fill = Treatment)) +
geom_point(size = I(2), shape = 21) +
scale_fill_manual(name = NULL, values = c("white", "grey", "black"), labels = labels) +
multivar.theme +
theme(legend.position = "bottom") +
ylab(paste0("PC2 (",round(summary(tea.pca2)$importance[2,2]*100, 2), "%)")) +
xlab(paste0("PC1 (",round(summary(tea.pca2)$importance[2,1]*100, 2), "%)"))
ggsave("Field Trial bw3.png", height = 3.33, width = 5, units = "in")
ggsave("Field Trial bw3.png", height = 3.33, width = 3.5, units = "in")
ggplot(as.data.frame(tea.pca2$x), aes(PC1, PC2, fill = Treatment)) +
geom_point(size = I(2), shape = 21) +
scale_fill_manual(name = NULL, values = c("white", "grey", "black"), labels = labels) +
multivar.theme +
theme(legend.position = "bottom") +
ylab(paste0("PC2 (",round(summary(tea.pca2)$importance[2,2]*100, 2), "%)")) +
xlab(paste0("PC1 (",round(summary(tea.pca2)$importance[2,1]*100, 2), "%)"))
ggsave("Field Trial bw3.png", height = 3.33, width = 3.5, units = "in")
ggplot(as.data.frame(tea.pca2$x), aes(PC1, PC2, fill = Treatment)) +
geom_point(size = I(2), shape = 21) +
scale_fill_manual(name = NULL, values = c("white", "grey", "black"), labels = labels, guide = FALSE) +
multivar.theme +
theme(legend.position = "bottom") +
ylab(paste0("PC2 (",round(summary(tea.pca2)$importance[2,2]*100, 2), "%)")) +
xlab(paste0("PC1 (",round(summary(tea.pca2)$importance[2,1]*100, 2), "%)"))
ggsave("Field Trial bw3.png", height = 3.33, width = 3.5, units = "in")
ggplot(as.data.frame(tea.pca2$x), aes(PC1, PC2, fill = Treatment)) +
geom_point(size = I(2), shape = 21) +
scale_fill_manual(name = NULL, values = c("white", "grey", "black"), labels = labels, guide = TRUE) +
multivar.theme +
theme(legend.position = "top") +
ylab(paste0("PC2 (",round(summary(tea.pca2)$importance[2,2]*100, 2), "%)")) +
xlab(paste0("PC1 (",round(summary(tea.pca2)$importance[2,1]*100, 2), "%)"))
ggplot(as.data.frame(tea.pca2$x), aes(PC1, PC2, fill = Treatment)) +
geom_point(size = I(2), shape = 21) +
scale_fill_manual(name = NULL, values = c("white", "grey", "black"), labels = labels) +
multivar.theme +
theme(legend.position = "top") +
ylab(paste0("PC2 (",round(summary(tea.pca2)$importance[2,2]*100, 2), "%)")) +
xlab(paste0("PC1 (",round(summary(tea.pca2)$importance[2,1]*100, 2), "%)"))
ggsave("Field Trial bw3.png", height = 3.33, width = 3.5, units = "in")
ggplot(as.data.frame(tea.pca2$x), aes(PC1, PC2, fill = Treatment)) +
geom_point(size = I(2), shape = 21) +
scale_fill_manual(name = NULL, values = c("white", "grey", "black"), labels = labels) +
multivar.theme +
theme(legend.position = "top") +
theme(legend.margin = margin(t = 3, b = 3, r = 6, l = 1)) +
ylab(paste0("PC2 (",round(summary(tea.pca2)$importance[2,2]*100, 2), "%)")) +
xlab(paste0("PC1 (",round(summary(tea.pca2)$importance[2,1]*100, 2), "%)"))
ggsave("Field Trial bw3.png", height = 3.33, width = 3.5, units = "in")
